<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <data>

    <record id="budget_masterx_action" model="ir.actions.act_window">
        <field name="name">Master Budget</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">master.budget</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree,form,calendar,pivot,graph</field>

        <field name="search_view_id" eval="False"/> <!-- Force empty -->
        <field name="view_id" eval="False"/> <!-- Force empty -->
        <field name="help" type="html">
          <p class="oe_view_nocontent_create">
            Click to Create a Master Budget.
          </p><p>
           The workflow is a thus; Create a Master budget,select analytic account, <br/>Any other budgets with same analytic account and state validated
            will be appended to it.<br/>
            A
          </p>
        </field>
    </record>
    <record id="ancil_budget_action" model="ir.actions.act_window">
        <field name="name">Ancilliary Budget</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">ancil.budget</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree,form</field>

        <field name="search_view_id" eval="False"/> <!-- Force empty -->
        <field name="view_id" eval="False"/> <!-- Force empty -->
        <field name="help" type="html">
          <p class="oe_view_nocontent_create">
            Click to Create an Ancilliary Budget.
          </p><p>

            A
          </p>
        </field>
    </record>

    <record id="main_buidling_budget_action" model="ir.actions.act_window">
        <field name="name">Main Building Budget</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">build.budget</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree,form</field>

        <field name="search_view_id" eval="False"/> <!-- Force empty -->
        <field name="view_id" eval="False"/> <!-- Force empty -->
        <field name="help" type="html">
          <p class="oe_view_nocontent_create">
            Click to Create an Building Budget.
          </p><p>

            A
          </p>
        </field>
    </record>




    <record id="infrastruture_budget_action" model="ir.actions.act_window">
        <field name="name">Infrastructure Budget</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">infrastructure.budget</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree,form</field>

        <field name="search_view_id" eval="False"/> <!-- Force empty -->
        <field name="view_id" eval="False"/> <!-- Force empty -->
        <field name="help" type="html">
          <p class="oe_view_nocontent_create">
            Click to Create an Infrastructure Budget.
          </p><p>

          </p>
        </field>
    </record>

    <record id="opexx_budget_action" model="ir.actions.act_window">
        <field name="name">Opex Budget</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">opex.budget</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree,form</field>

        <field name="search_view_id" eval="False"/> <!-- Force empty -->
        <field name="view_id" eval="False"/> <!-- Force empty -->
        <field name="help" type="html">
          <p class="oe_view_nocontent_create">
            Click to Create an Opex Budget.
          </p><p>

          </p>
        </field>
    </record>

    <record id="capexx_budget_action" model="ir.actions.act_window">
        <field name="name">Capex Budget</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">capex.budget</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree,form</field>

        <field name="search_view_id" eval="False"/> <!-- Force empty -->
        <field name="view_id" eval="False"/> <!-- Force empty -->
        <field name="help" type="html">
          <p class="oe_view_nocontent_create">
            Click to Create a Capex Budget.
          </p><p>

          </p>
        </field>
    </record>

    <record id="salaryx_budget_action" model="ir.actions.act_window">
        <field name="name">Salary Budget</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">salary.budget</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree,form</field>

        <field name="search_view_id" eval="False"/> <!-- Force empty -->
        <field name="view_id" eval="False"/> <!-- Force empty -->
        <field name="help" type="html">
          <p class="oe_view_nocontent_create">
            Click to Create a Salary Budget.
          </p><p>

            A
          </p>
        </field>
    </record>


    <menuitem id="main_master_view_id" name = "Master Budget" sequence="7" action="budget_masterx_action"/>


    <menuitem id="mastes_budget_view_id" name = "Budget" sequence="1"
         parent="main_master_view_id"/>
         <menuitem id="master_budget_view_id" name = "Master Budget" sequence="1"
         parent="main_master_view_id" action="budget_masterx_action"/>

    <menuitem id="construction_budget_view_id" name = "Construction" sequence="2"
         parent="main_master_view_id"/>

         <menuitem id="buildx_budget_view_id" name = "Building Budget" sequence="1"
         parent="construction_budget_view_id" action="main_buidling_budget_action"/>

         <menuitem id="infras_budget_view_id" name = "Infrastructure Budget" sequence="2"
         parent="construction_budget_view_id" action="infrastruture_budget_action"/>

         <menuitem id="ancil_budget_view_id" name = "Ancilliary Budget" sequence="3"
         parent="construction_budget_view_id" action="ancil_budget_action"/>



    <menuitem id="overhead_view_budgets" name = "Overhead" sequence="3"
         parent="main_master_view_id"/>

         <menuitem id="opexx_view_budgets" name = "Opex Budget" sequence="1"
         parent="overhead_view_budgets" action="opexx_budget_action"/>
         <menuitem id="capexx_view_budgets" name = "Capex Budget" sequence="2"
         parent="overhead_view_budgets" action="capexx_budget_action"/>

    <menuitem id="salaries_view_budgets" name = "Salary" sequence="4"
         parent="main_master_view_id"/>
         <menuitem id="salaryx_view_budgets" name = "Salary Budget" sequence="1"
         parent="salaries_view_budgets" action="salaryx_budget_action"/>



    <record model="ir.ui.view" id="product_product_budget" >
            <field name="name">product.template</field>
            <field name="model">product.template</field>
            <field name="inherit_id" ref="product.product_template_only_form_view" />
            <field name="arch" type="xml">

                <xpath expr="//field[@name='default_code']" position="before">
                           <field name="capex_period" invisible="0"/>

                </xpath>

            </field>
        </record>



        <record id="master_budgetx_custom_form" model="ir.ui.view">
            <field name="name">master.budget.form</field>
            <field name="model">master.budget</field>
            <field name="arch" type="xml">
                <form string="Budget">
                <header>
                    <button name="confirm_budget" states="draft" string="Submit Budget" type="object" />

                    <button name="validate_budget" states="confirm" string="Validate" type="object" />
                    <!--<button name="done_button" states="validate" string="Done" type="object" />-->

                    <button name="cancel_budget" states="validate,confirm" string="Cancel" type="object" />
                    <button name="set_draft_budget" states="cancel" string="Set to draft" type="object" />
                    <field name="state" widget="statusbar" statusbar_visible="draft,confirm,validate" readonly="1"/>
                </header>
                <sheet>
                <div class="oe_title">
                        <label string="Budget Name"/>
                        <h1>
                            <field name="name" readonly="1"/>
                        </h1>
                </div>

                        <group>
                            <group>


                                <field name="creating_user_id" attrs="{'readonly':[('state','!=','draft')]}"/>
                                <field name="budget_category"/>
                                <field name="budget_master" attrs="{'invisible':[('budget_category','=','master')]}"/>
                                <field name="project_name"/>
                                <field name="analytic_account_id"/>

                            </group>
                            <group>
                                <label for="date_from" string="Period"/>
                                <div>
                                    <field name="date_from" class="oe_inline" attrs="{'readonly':[('state','!=','draft')]}"/> -
                                    <field name="date_to" class="oe_inline" attrs="{'readonly':[('state','!=','draft')]}" nolabel="1"/>
                                </div>

                                <field name="purpose" placeholder="Write Purpose" readonly="0"/>
                                 <field name="budget_amount_before"/>
                                  <field name="budget_amount_after"/>
                                  <field name="released_amount"/>
                                  <field name="released_amount_date"/>
                                  <field name="balance_amount"/>
                                  <field name="percentage" widget="percentpie"/>
                            </group>

                        </group>
                        <!--<notebook>
                        <page string="Building Budget">
                        <field name="buildmain_budget_lines">
                            <tree string="Building Budget Lines" editable="bottom">
                                    <field name="name" invisible="0" required = "1"/>
                                    <field name="creating_user_id"/>
                                    <field name="budget_amount_before" sum ="Budget Amount Before Variance"/>
                                    <field name="budget_amount_after" sum ="Budget Amount After Variance"/>
                                    <field name="released_amount" sum ="Released Amount"/>
                                    <field name="date_from" invisible="0"/>
                                    <field name="approve_date" invisible="0"/>
                                </tree>

                        </field>
                        </page>
                        <page string="Infrastructure Budget">
                            <field name="infrasture_budget_lines" attrs="{'readonly': [('state', 'in', ('validate', 'done'))]}">
                                 <tree string="Infrastructure Lines" editable="bottom">
                                    <field name="boq" invisible="0" required = "1"/>
                                    <field name="stage"/>

                                    <field name="total_amount" sum ="Total Amount"/>

                                    <field name="released_amount" sum ="Released Amount"/>
                                    <field name="state" invisible="0"/>
                                </tree>

                            </field>
                        </page>
                        <page string="Opex Budget">
                            <field name="opex_budget_lines" attrs="{'readonly': [('state', 'in', ('validate', 'done'))]}">
                                 <tree string="Opex Budget Lines" editable="bottom">
                                    <field name="total_amount" sum ="Total Amount"/>
                                    <field name="total_after"/>
                                    <field name="approve_checkin_date" invisible="0"/>
                                    <field name="released_amount" sum ="Released Amount"/>
                                    <field name="state" invisible="0"/>
                                </tree>

                            </field>

                        </page>
                        <page string="Capex Budget">
                            <field name="capex_budget_lines" attrs="{'readonly': [('state', 'in', ('validate', 'done'))]}">
                                 <tree string="Capex Budget Lines" editable="bottom">
                                    <field name="total_amount" sum ="Total Amount"/>
                                    <field name="total_after"/>
                                    <field name="approve_checkin_date" invisible="0"/>
                                    <field name="released_amount" sum ="Released Amount"/>
                                    <field name="state" invisible="0"/>
                                </tree>


                             </field>
                        </page>

                        <page string="Salary Budget">
                            <field name="salaries_budget_lines" attrs="{'readonly': [('state', 'in', ('validate', 'done'))]}">
                                 <tree string="Salary Budget Lines" editable="bottom">
                                    <field name="total_amount" sum ="Total Amount"/>
                                    <field name="released_amount" sum ="Released Amount"/>
                                    <field name="difference_budget" sum="Difference Amount" />
                                    <field name="approve_checkin_date" invisible="0"/>
                                    <field name="state" invisible="0"/>
                                </tree>

                            </field>

                        </page>
                        </notebook>-->
                    <notebook>
                        <page string="Building Budget">
                            <field name="buildmain_budget_lines" attrs="{'readonly': [('state', 'in', ('validate', 'done'))]}">
                                 <tree string="Building Budget Lines" editable="bottom">
                                 <field name="master_build_line_id" invisible="0" required = "1"/>
                                    <field name="name" invisible="0" required = "0"/>
                                    <field name="creating_user_id"/>
                                    <field name="budget_amount_before" sum ="Budget Amount Before Variance"/>
                                    <field name="budget_amount_after" sum ="Budget Amount After Variance"/>
                                    <field name="released_amount" sum ="Released Amount"/>
                                    <field name="date_from" invisible="0"/>
                                    <field name="approve_date" invisible="0"/>
                                </tree>

                            <form string="Budget items">
                                    <group>
                                        <group colspan="4">
                                           <field name="name" invisible="0" required = "1"/>
                                            <field name="creating_user_id"/>
                                            <field name="budget_amount_before" sum ="Budget Amount Before Variance"/>
                                            <field name="budget_amount_after" sum ="Budget Amount After Variance"/>

                                        </group>
                                        <group>
                                           <field name="released_amount" sum ="Released Amount"/>
                                            <field name="date_from" invisible="0"/>
                                            <field name="approve_date" invisible="0"/>
                                        </group>
                                    </group>
                                    <field name="build_budget_lines"/>
                                </form>
                            </field>

                        </page>

                        <page string="Infrastructure Budget">
                            <field name="infrasture_budget_lines" readonly="0">
                                 <tree string="Infrastructure Lines">
                                    <field name="boq" invisible="0" required = "1"/>
                                    <field name="stage"/>

                                    <field name="total_amount" sum ="Total Amount"/>

                                    <field name="released_amount" sum ="Released Amount"/>


                                    <field name="state" invisible="0"/>
                                </tree>
                                <form string="Budget items">
                                    <group>
                                        <group colspan="4">

                                           <field name="boq" invisible="0" required = "1"/>
                                            <field name="stage"/>

                                            <field name="total_amount" sum ="Total Amount"/>
                                        </group>
                                        <group>
                                           <field name="released_amount" sum ="Released Amount"/>

                                        </group>
                                    </group>
                                    <separator string="Activities Lines" colspan="4"/>
                                    <field name="stage_activity_lines" readonly = "0">

                                        <tree string="Building Item Lines">
                                            <field name="activity_task" invisible="0" required = "0"/>
                                            <field name="total_amount"/>

                                        </tree>

                                        <form string="Infrastructure Item Lines" editable="bottom">
                                            <group>
                                                <group colspan="4">
                                                <field name="activity_task" invisible="0" required = "0"/>

                                                </group>
                                                <group>
                                                    <field name="total_amount"/>
                                                </group>
                                            </group>

                                            <separator string="Material Lines" colspan="4"/>
                                                <field name="stage_datas_material" readonly="0">
                                                    <form string="Activity Line">
                                                        <group>
                                                            <group colspan="4">

                                                                <field name="product_id"/>
                                                                <field name="qty"/>
                                                                <field name="label"/>
                                                            </group>
                                                            <group>
                                                                <field name="rate"/>
                                                                <field name="total"/>
                                                             </group>
                                                         </group>
                                                    </form>

                                                </field>
                                            <separator string="Labour Lines" colspan="4"/>
                                                <field name="stage_datas_labour" readonly="0">
                                                    <form string="Activity Line">
                                                            <group>
                                                                <group colspan="4">

                                                                    <field name="activity_id"/>
                                                                    <field name="qty"/>
                                                                    <field name="label"/>
                                                                </group>
                                                                <group>
                                                                    <field name="rate"/>
                                                                    <field name="amount_total"/>
                                                                 </group>
                                                             </group>
                                                        </form>

                                                </field>


                                        </form>
                                </field>


                                </form>
                            </field>

                        </page>


                        <page string="Opex Budget">
                            <field name="opex_budget_lines" readonly="0"><!--attrs="{'readonly': [('state', 'in', ('validate', 'done'))]}">-->
                                 <tree string="Opex Budget Lines" editable="bottom">
                                    <field name="total_amount" sum ="Total Amount"/>
                                    <field name="total_after"/>
                                    <field name="approve_checkin_date" invisible="0"/>
                                    <field name="released_amount" sum ="Released Amount"/>
                                    <field name="state" invisible="0"/>
                                </tree>
                            <form string="Budget items">
                                    <group>
                                        <group colspan="4">

                                           <field name="total_amount" sum ="Total Amount"/>
                                            <field name="total_after"/>
                                            <field name="approve_checkin_date" invisible="0"/>
                                        </group>
                                        <group>
                                           <field name="released_amount" sum ="Released Amount"/>
                                           <field name="state" invisible="0"/>
                                        </group>
                                    </group>
                                    <field name="opex_lines"/>
                                </form>
                            </field>

                        </page>



                        <page string="Capex Budget">
                            <field name="capex_budget_lines" readonly="0">
                                 <tree string="Capex Budget Lines" editable="bottom">
                                    <field name="total_amount" sum ="Total Amount"/>
                                    <field name="total_after"/>
                                    <field name="approve_checkin_date" invisible="0"/>
                                    <field name="released_amount" sum ="Released Amount"/>
                                    <field name="state" invisible="0"/>
                                </tree>
                            <form string="Budget items">
                                    <group>
                                        <group colspan="4">

                                           <field name="total_amount" sum ="Total Amount"/>
                                            <field name="total_after"/>
                                            <field name="approve_checkin_date" invisible="0"/>
                                        </group>
                                        <group>
                                           <field name="released_amount" sum ="Released Amount"/>
                                           <field name="state" invisible="0"/>
                                        </group>
                                    </group>
                                    <field name="capex_lines"/>
                                </form>
                            </field>
                        </page>


                         <page string="Salary Budget">
                            <field name="salaries_budget_lines" readonly="0">
                                 <tree string="Salary Budget Lines" editable="bottom">
                                    <field name="total_amount" sum ="Total Amount"/>
                                    <field name="released_amount" sum ="Released Amount"/>
                                    <field name="difference_budget" sum="Difference Amount" />
                                    <field name="approve_checkin_date" invisible="0"/>
                                    <field name="state" invisible="0"/>
                                </tree>
                            <form string="Budget items">
                                    <group>
                                        <group colspan="4">

                                           <field name="total_amount" sum ="Total Amount"/>
                                            <field name="released_amount" sum ="Released Amount"/>
                                            <field name="difference_budget" sum="Difference Amount" />
                                        </group>
                                        <group>
                                           <field name="approve_checkin_date" invisible="0"/>
                                            <field name="state" invisible="0"/>
                                        </group>
                                    </group>
                                     <field name="salary_lines"/>
                                </form>
                            </field>

                        </page>
                      </notebook>
                    </sheet>
                <div class="oe_chatter">
                    <field name="message_follower_ids" widget="mail_followers"/>
                    <field name="message_ids" widget="mail_thread"/>
                </div>
                </form>
            </field>
        </record>


        <record model="ir.ui.view" id="masterx_budget_view_tree">
            <field name="name">master.budget.view.tree</field>
            <field name="model">master.budget</field>
            <field name="arch" type="xml">
               <tree decoration-info="state == 'draft'" decoration-muted="state in ('done','cancel')" string="Budget">
                    <field name="name" colspan="1"/>
                    <field name="creating_user_id"/>
                    <field name="date_from"/>
                    <field name="date_to"/>
                    <field name="budget_amount_before"/>
                    <field name="budget_amount_after"/>
                    <field name="released_amount"/>
                    <field name="balance_amount" />
                    <field name="percentage"/>
                    <field name="state"/>
                </tree>
            </field>
        </record>

         <record id="masterx_budget_search" model="ir.ui.view">
           <field name="name">master.budget.search</field>
           <field name="model">master.budget</field>
           <field name="arch" type="xml">
               <search string="Master Budget">
                    <field name="name" filter_domain="[('name','ilike',self)]" string="Budget"/>
                    <field name="date_from"/>
                    <field name="date_to"/>
                    <filter string="Draft" domain="[('state','=','draft')]" help="Draft Budgets"/>
                    <filter string="To Approve" domain="[('state','=','confirm')]" help="To Approve Budgets" />
                    <field name="state"/>
                </search>
            </field>
        </record>
        <record model="ir.ui.view" id="xmaster_budget_calendar">
            <field name="name">master.budget.calendar</field>
            <field name="model">master.budget</field>
            <field name="priority" eval="2"/>
            <field name="arch" type="xml">
                <calendar string="Calendar View" date_start="date_from">
                    <field name="name"/>
                    <field name="budget_amount_before" widget="monetary"/>
                    <field name="balance_amount" widget="monetary"/>
                </calendar>
            </field>
        </record>


        <record model="ir.ui.view" id="masterx_budget_custom_pivot">
            <field name="name">master.budget.custom.pivot</field>
            <field name="model">master.budget</field>
            <field name="arch" type="xml">
                <pivot string="Master Budget" display_quantity="True">

                    <field name="budget_amount_before" widget="measure"/>
                    <field name="balance_amount" widget="measure"/>
                </pivot>

            </field>
        </record>

        <record model="ir.ui.view" id="master_budget_custom_graph">
            <field name="name">master.budget.graph</field>
            <field name="model">master.budget</field>
            <field name="arch" type="xml">
                <graph string="Building Budget">
                    <field name="percentage" type="measure" />
                    <field name="budget_amount_before" type="measure"/>
                </graph>
            </field>
        </record>





<!--  ############## #################     BUILD BUDGET ############## ####################### -->
        <record id="build_budgetx_custom_form" model="ir.ui.view">
            <field name="name">build.budget.form</field>
            <field name="model">build.budget</field>
            <field name="arch" type="xml">
                <form string="Budget">
                <header>
                    <button name="confirm_budget" states="draft" string="Submit Budget" type="object" />

                    <button name="validate_budget" states="confirm" string="Validate" type="object" />
                    <!--<button name="done_button" states="validate" string="Done" type="object" />-->

                    <button name="cancel_budget" states="validate,confirm" string="Cancel" type="object" />
                    <button name="set_draft_budget" states="cancel" string="Set to draft" type="object" />
                    <field name="state" widget="statusbar" statusbar_visible="draft,confirm,validate" readonly="1"/>
                </header>
                <sheet>
                <div class="oe_title">
                        <label string="Budget Name"/>
                        <h1>
                            <field name="name" readonly="0"/>
                        </h1>
                </div>
                        <group>
                            <group>
                                <field name="master_build_line_id" required="1"/>
                                <field name="creating_user_id" attrs="{'readonly':[('state','!=','draft')]}"/>
                                <field name="budget_category"/>

                                <field name="project_name" string="Plot/Unit"/>
                                <field name="analytic_account_id"/>
                                <field name="total_plots"/>
                                  <field name="total_activities"/>
                                  <field name="total_blocks"/>


                            </group>
                            <group>
                                <label for="date_from" string="Period"/>
                                <div>
                                    <field name="date_from" class="oe_inline" attrs="{'readonly':[('state','!=','draft')]}"/> -
                                    <field name="date_to" class="oe_inline" attrs="{'readonly':[('state','!=','draft')]}" nolabel="1"/>
                                </div>

                                <field name="purpose" placeholder="Write Purpose" readonly="0"/>
                                 <field name="budget_amount_before"/>
                                  <field name="budget_amount_after"/>
                                  <field name="released_amount"/>
                                  <field name="released_amount_date"/>

                            </group>
                        </group>
                        <notebook>

                        <page string="Building Items">
                        <field name="build_budget_lines">
                            <tree string="Building Item Lines" editable="bottom">
                                    <field name="type_id"/>
                                    <field name="project_name" invisible="0" required = "0"/>
                                    <field name="house_type" attrs="{'invisible':[('type_id','=',False)]}" />
                                    <field name="block" attrs="{'invisible':[('type_id','=',True)]}"/>
                                    <field name="quantity"/>

                                    <field name="activity_stage_id" required = "1"/>
                                    <field name="amount_in_qty"/>
                                    <field name="estimate_amount" />
                                    <field name="create_date" />

                                </tree>

                        </field>
                        </page>


                        </notebook>
                    </sheet>

                </form>
            </field>
        </record>


        <record model="ir.ui.view" id="build_budget_view_tree">
            <field name="name">build.budget.view.tree</field>
            <field name="model">build.budget</field>
            <field name="arch" type="xml">
               <tree string="Budget">
                    <field name="name" colspan="1"/>
                    <field name="master_build_line_id"/>
                    <field name="creating_user_id"/>
                    <field name="project_name"/>
                    <field name="date_from"/>
                    <field name="date_to"/>
                    <field name="budget_amount_before"/>
                    <field name="budget_amount_after"/>
                    <field name="released_amount"/>


                    <field name="state"/>


                </tree>
            </field>
        </record>

         <record id="buildbudget_search" model="ir.ui.view">
           <field name="name">build.budget.search</field>
           <field name="model">build.budget</field>
           <field name="arch" type="xml">
               <search string="Building Budget">
                    <field name="name" filter_domain="[('name','ilike',self)]" string="Budget"/>
                    <field name="date_from"/>
                    <field name="date_to"/>
                    <filter string="Draft" domain="[('state','=','draft')]" help="Draft Budgets"/>
                    <filter string="To Approve" domain="[('state','=','confirm')]" help="To Approve Budgets" />
                    <field name="state"/>
                </search>
            </field>
        </record>




           <!--  ############## #################     INFRASTRUCTURE BUDGET ############## ####################### -->

        <record id="infrastructure_custom_form" model="ir.ui.view">
            <field name="name">infrastructure.budget.form</field>
            <field name="model">infrastructure.budget</field>
            <field name="arch" type="xml">
                <form string="Budget">
                <header>
                    <button name="confirm_budget" states="draft" string="Submit Budget" type="object" />

                    <button name="validate_budget" states="confirm" string="Validate" type="object" />
                    <!--<button name="done_button" states="validate" string="Done" type="object" />-->

                    <button name="cancel_budget" states="validate,confirm" string="Cancel" type="object" />
                    <button name="set_draft_budget" states="cancel" string="Set to draft" type="object" />
                    <field name="state" widget="statusbar" statusbar_visible="draft,confirm,validate" readonly="1"/>
                </header>
                <sheet>
                <div class="oe_title">
                        <label string="BOQ Name"/>
                        <h1>
                            <field name="boq" readonly="0"/>
                        </h1>
                </div>
                        <group>
                            <group>
                            <field name="master_build_line_id" required="1"/>
                                <field name="stage"/>

                            </group>
                            <group>
                                <field name="total_amount"/>
                                <field name="released_amount"/>
                            </group>
                        </group>
                        <notebook>

                        <page string="Infrastructure Items">
                        <field name="stage_activity_lines" readonly="0">
                            <tree string="Building Item Lines">
                                    <field name="activity_task" invisible="0" required = "0"/>
                                    <field name="total_amount" readonly="0"/>

                                </tree>
                            <form string="Infrastructure Item Lines" editable="bottom">
                                <group>
                                    <group colspan="4">
                                    <field name="activity_task" invisible="0" required = "0"/>

                                    </group>
                                    <group>
                                        <field name="total_amount"/>
                                    </group>
                                </group>

                                    <separator string="Material Lines" colspan="4"/>
                                    <field name="stage_datas_material" readonly="0">
                                        <form string="Activity Line">
                                            <group>
                                                <group colspan="4">

                                                    <field name="product_id"/>
                                                    <field name="qty"/>
                                                    <field name="label"/>
                                                </group>
                                                <group>
                                                    <field name="rate"/>
                                                    <field name="total"/>
                                                 </group>
                                             </group>
                                        </form>

                                    </field>
                                    <separator string="Labour Lines" colspan="4"/>
                                    <field name="stage_datas_labour" readonly="0">
                                        <form string="Activity Line">
                                                <group>
                                                    <group colspan="4">

                                                        <field name="activity_id"/>
                                                        <field name="qty"/>
                                                        <field name="label"/>
                                                    </group>
                                                    <group>
                                                        <field name="rate"/>
                                                        <field name="amount_total"/>
                                                     </group>
                                                 </group>
                                            </form>

                                    </field>

                                </form>

                        </field>
                        </page>


                        </notebook>
                    </sheet>

                </form>
            </field>
        </record>


        <record model="ir.ui.view" id="infrastructure_budget_view_tree">
            <field name="name">infrastructure.budget.view.tree</field>
            <field name="model">infrastructure.budget</field>
            <field name="arch" type="xml">
               <tree string="Budget">
               <field name="master_build_line_id" required="1"/>
                    <field name="boq" colspan="1"/>
                    <field name="stage"/>
                    <field name="total_amount"/>
                    <field name="released_amount"/>

                </tree>
            </field>
        </record>



        <!--  ############## #################     Opex BUDGET ############## ####################### -->

        <record id="opex_custom_form" model="ir.ui.view">
            <field name="name">opex.budget.form</field>
            <field name="model">opex.budget</field>
            <field name="arch" type="xml">
                <form string="Budget">
                <header>
                    <button name="confirm_budget" states="draft" string="Submit Budget" type="object" />

                    <button name="validate_budget" states="confirm" string="Validate" type="object" />
                    <!--<button name="done_button" states="validate" string="Done" type="object" />-->

                    <button name="cancel_budget" states="validate,confirm" string="Cancel" type="object" />
                    <button name="set_draft_budget" states="cancel" string="Set to draft" type="object" />
                    <field name="state" widget="statusbar" statusbar_visible="draft,confirm,validate" readonly="1"/>
                </header>
                <sheet>
                        <group>
                            <group>
                            <field name="master_build_line_id" required="1"/>
                                <field name="total_amount"/>

                                <field name="released_amount"/>

                            </group>
                            <group>
                            <field name="total_after"/>
                                <field name="approve_checkin_date"/>

                            </group>
                        </group>
                        <notebook>

                        <page string="Opex Items">
                        <field name="opex_lines" readonly="0">
                            <tree string="Opex Item Lines" editable ="bottom">
                                    <field name="description"/>
                                    <field name="month"/>
                                    <field name="period"/>
                                    <field name="product_id" required="1"/>
                                    <field name="label"/>
                                    <field name="qty"/>
                                    <field name="rate"/>
                                    <field name="budget"/>
                                    <field name="budget_release"/>
                                     <field name="total"/>

                            </tree>
                            <form string="Opex Item Lines" editable="bottom">
                                <group>
                                    <group colspan="4">
                                        <field name="description" placeholder="Enter description" invisible="0" required = "0"/>
                                        <field name="month"/>
                                        <field name="period"/>
                                        <field name="product_id" required="1"/>
                                        <field name="label"/>
                                        <field name="qty"/>
                                    </group>
                                    <group>
                                        <field name="rate"/>
                                        <field name="budget"/>
                                        <field name="budget_release"/>
                                         <field name="total"/>
                                    </group>
                                </group>
                                </form>

                        </field>
                        </page>


                        </notebook>
                    </sheet>

                </form>
            </field>
        </record>


        <record model="ir.ui.view" id="opex_budget_view_tree">
            <field name="name">opex.budget.view.tree</field>
            <field name="model">opex.budget</field>
            <field name="arch" type="xml">

               <tree string="Budget">
                    <field name="master_build_line_id" required="1"/>
                    <field name="total_amount"/>
                    <field name="released_amount"/>
                    <field name="total_after"/>
                    <field name="approve_checkin_date"/>

                </tree>
            </field>
        </record>



        <!--  ############## #################    Capex BUDGET ############## ####################### -->

        <record id="capex_custom_form" model="ir.ui.view">
            <field name="name">capex.budget.form</field>
            <field name="model">capex.budget</field>
            <field name="arch" type="xml">
                <form string="Budget">
                <header>
                    <button name="confirm_budget" states="draft" string="Submit Budget" type="object" />

                    <button name="validate_budget" states="confirm" string="Validate" type="object" />
                    <!--<button name="done_button" states="validate" string="Done" type="object" />-->

                    <button name="cancel_budget" states="validate,confirm" string="Cancel" type="object" />
                    <button name="set_draft_budget" states="cancel" string="Set to draft" type="object" />
                    <field name="state" widget="statusbar" statusbar_visible="draft,confirm,validate" readonly="1"/>
                </header>
                <sheet>
                        <group>
                            <group>
                            <field name="master_build_line_id" required="1"/>
                                <field name="total_amount"/>

                                <field name="released_amount"/>

                            </group>
                            <group>
                            <field name="total_after"/>
                                <field name="approve_checkin_date"/>

                            </group>
                        </group>
                        <notebook>

                        <page string="Capex Items">
                        <field name="capex_lines" readonly="0">
                            <tree string="Capex Item Lines" editable ="bottom">
                                    <field name="description"/>
                                    <field name="month"/>
                                    <field name="period"/>
                                    <field name="product_id" required="1"/>
                                    <field name="label"/>
                                    <field name="qty"/>
                                    <field name="rate"/>
                                    <field name="budget"/>
                                    <field name="budget_release"/>
                                     <field name="total"/>

                            </tree>
                            <form string="Capex Item Lines" editable="bottom">
                                <group>
                                    <group colspan="4">
                                        <field name="description" placeholder="Enter description" invisible="0" required = "0"/>
                                        <field name="month"/>
                                        <field name="period"/>
                                        <field name="product_id" required="1"/>
                                        <field name="label"/>
                                        <field name="qty"/>
                                    </group>
                                    <group>
                                        <field name="rate"/>
                                        <field name="budget"/>
                                        <field name="budget_release"/>
                                         <field name="total"/>
                                    </group>
                                </group>
                                </form>

                        </field>
                        </page>


                        </notebook>
                    </sheet>

                </form>
            </field>
        </record>


        <record model="ir.ui.view" id="capexx_budget_view_tree">
            <field name="name">capexx.budget.view.tree</field>
            <field name="model">capex.budget</field>
            <field name="arch" type="xml">

               <tree string="Budget">
                    <field name="master_build_line_id" required="1"/>
                    <field name="total_amount"/>
                    <field name="released_amount"/>
                    <field name="total_after"/>
                    <field name="approve_checkin_date"/>

                </tree>
            </field>
        </record>




        <record id="stage_activity_custom_form" model="ir.ui.view">
            <field name="name">stage.activity.line.form</field>
            <field name="model">stage.activity.line</field>
            <field name="arch" type="xml">
                <form string="Stage and ACtivity Line">
                <header>

                </header>
                <sheet>
                        <div class="oe_title">
                        <label string="BOQ Name"/>
                        <h1>
                            <field name="boq" readonly="0"/>
                        </h1>
                </div>


                        <group>
                            <group>

                                <field name="stage"/>
                                <field name="analytic_account_id"/>
                            </group>
                            <group>
                                <field name="total_amount"/>

                            </group>
                        </group>
                        <notebook>

                        <page string="Activity Items">
                        <field name="stage_activity_lines" readonly="0">
                            <tree string="Activity Item Lines">
                                    <field name="activity_task" invisible="0" required = "0"/>
                                    <field name="total_amount" readonly="0"/>

                                </tree>
                            <form string="Activity Item Lines" editable="bottom">
                                <group>
                                    <group colspan="4">
                                    <field name="activity_task" invisible="0" required = "0"/>

                                    </group>
                                    <group>
                                        <field name="total_amount"/>
                                    </group>
                                </group>

                                    <separator string="Material Lines" colspan="4"/>
                                    <field name="stage_datas_material" readonly="0">
                                        <form string="Activity Line">
                                            <group>
                                                <group colspan="4">

                                                    <field name="product_id"/>
                                                    <field name="qty"/>
                                                    <field name="label"/>
                                                </group>
                                                <group>
                                                    <field name="rate"/>
                                                    <field name="total"/>
                                                 </group>
                                             </group>
                                        </form>

                                    </field>
                                    <separator string="Labour Lines" colspan="4"/>
                                    <field name="stage_datas_labour" readonly="0">
                                        <form string="Activity Line">
                                                <group>
                                                    <group colspan="4">

                                                        <field name="activity_id"/>
                                                        <field name="qty"/>
                                                        <field name="label"/>
                                                    </group>
                                                    <group>
                                                        <field name="rate"/>
                                                        <field name="amount_total"/>
                                                     </group>
                                                 </group>
                                            </form>

                                    </field>

                                </form>

                        </field>
                        </page>


                        </notebook>
                    </sheet>

                </form>
            </field>
        </record>

        </data>
        <data>
            <record id="seqmaster_custom_budget" model="ir.sequence">
                <field name="name">master.budget</field>
                <field name="code">master.budget</field>
                <field name="prefix">MB/</field>
                <field name="padding">5</field>
            </record>
            <!--<record id="seq_building_budget" model="ir.sequence">
                <field name="name">building.budget</field>
                <field name="code">building.budget</field>
                <field name="prefix">BB/</field>
                <field name="padding">5</field>
            </record>-->
        </data>

</odoo>
















       <!-- <record id="building_budget_action" model="ir.actions.act_window">
            <field name="name">Building Budget</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">building.budget</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form,calendar,pivot</field>

            <field name="search_view_id" eval="False"/>
            <field name="view_id" eval="False"/>
            <field name="help" type="html">
              <p class="oe_view_nocontent_create">
                Click to Add a Building Budget.
              </p><p>
                You must define a Budget for Your project.
              </p><p>
                The workflow is a thus; Create a budget and fiscal position for the building project,<p/>
                If the cost and items does not match the budget selected, it throws a restriction
              </p>
            </field>
        </record>



        <menuitem
            id="building_budget_view_act" name = "Building Item Request" sequence="2"
            parent="act_budget_view_id" action="building_budget_action"/>

        <record model="ir.ui.view" id="building_budget_calendar">
            <field name="name">budget.custom.calendar</field>
            <field name="model">building.budget</field>
            <field name="priority" eval="2"/>
            <field name="arch" type="xml">
                <calendar string="Calendar View" date_start="date_from">
                    <field name="name"/>
                    <field name="material_total" widget="monetary"/>
                    <field name="labour_total" widget="monetary"/>
                </calendar>
            </field>
        </record>


        <record model="ir.ui.view" id="buildin_budget_custom_pivot">
            <field name="name">building.budget.custom.pivot</field>
            <field name="model">building.budget</field>
            <field name="arch" type="xml">
                <pivot string="Building Budget" display_quantity="True">

                    <field name="material_total" widget="measure"/>
                    <field name="labour_total" widget="measure"/>
                </pivot>

            </field>
        </record>

        <record model="ir.ui.view" id="building_budget_custom_graph">
            <field name="name">building.budget.graph</field>
            <field name="model">building.budget</field>
            <field name="arch" type="xml">
                <graph string="Building Budget">
                    <field name="activity_id"/>
                    <field name="total_dummy" type="measure"/>
                </graph>
            </field>
        </record>



        <record id="building_budget_custom_form" model="ir.ui.view">
            <field name="name">building.budget.custom.form</field>
            <field name="model">building.budget</field>
            <field name="arch" type="xml">
                <form string="Building ">
                <header>
                    <button name="submit_items" states="draft" string="Submit Budget" type="object" />

                    <button name="approve_items" states="sub" string="Validate" type="object" />
                    <button name="cancel_button" states="sub,done" string="Cancel" type="object" />
                    <button name="setdraft_button" states="cancel" string="Set Draft" type="object" />

                    <field name="state" widget="statusbar" statusbar_visible="draft,sub,done" readonly="1"/>
                </header>
                <sheet>
                <div class="oe_title">
                        <label string="Code"/>
                        <h1>
                            <field name="name" readonly="1"/>
                        </h1>
                </div>

                        <group>
                            <group>
                                <field name="project_id" attrs="{'readonly':[('state','!=','draft')]}"/>
                                <field name="plot_id" attrs="{'readonly':[('state','!=','draft')]}"/>

                                <field name="analytic_account_id" attrs="{'readonly':[('state','!=','draft')]}"/>
                                <field name="budget_id" attrs="{'readonly':[('state','!=','draft')]}"/>
                                <field name="activity_id" attrs="{'readonly':[('state','!=','draft')]}"/>
                                <field name="activity_cus" attrs="{'readonly':[('state','!=','draft')]}"/>

                            </group>
                            <group>
                                <label for="date_from" string="Period"/>
                                <div>
                                    <field name="date_from" class="oe_inline" attrs="{'readonly':[('state','!=','draft')]}"/> -
                                    <field name="date_to" class="oe_inline" attrs="{'readonly':[('state','!=','draft')]}" nolabel="1"/>
                                </div>
                                 <field name="material_total"/>
                                  <field name="labour_total"/>
                                  <field name="total_dummy" string = "Grand total"/>

                            </group>
                        </group>

                    <notebook>
                        <page string="Building Request tems">
                        <separator string="Material items" colspan="4" />
                            <field name="stage_datas_material" attrs="{'readonly': [('state', 'in', ('done', 'cancel'))]}">
                                 <tree string="Budget Lines" editable="bottom">
                                    <field name="product_id" invisible="0" required = "1"/>
                                    <field name="total_qty" sum="Total Quantity" invisible="0" required = "1"/>
                                    <field name="label" invisible="0"/>
                                    <field name="rate" invisible="0"/>

                                    <field name="total"/>

                                </tree>

                            </field>

                            <separator string="Labour items" colspan="4" />
                            <field name="stage_datas_labour" attrs="{'readonly': [('state', 'in', ('done', 'cancel'))]}">
                                 <tree string="Labour Lines" editable="bottom">
                                    <field name="name" invisible="0" required = "1"/>
                                    <field name="activity_id"  invisible="0" required = "0"/>
                                    <field name="qty" invisible="0"/>
                                    <field name="rate" invisible="0"/>
                                    <field name="amount_total"/>
                                </tree>

                            </field>
                        </page>

                      </notebook>
                    </sheet>

                </form>
            </field>
        </record>


        <record model="ir.ui.view" id="building_custom_budget_view_tree">
            <field name="name">building.budget.view.tree</field>
            <field name="model">building.budget</field>
            <field name="arch" type="xml">
               <tree decoration-info="state == 'draft'" decoration-muted="state in ('done','cancel')" string="Building Budget">
                    <field name="name" colspan="1"/>
                    <field name="date_from"/>
                    <field name="date_to"/>
                    <field name="project_id" attrs="{'readonly':[('state','!=','draft')]}"/>
                    <field name="material_total" sum="Material Total" />
                    <field name="labour_total" sum="Labour Total"/>
                    <field name="state"/>
                </tree>
            </field>
        </record>

         <record id="building_budget_budget_search" model="ir.ui.view">
           <field name="name">building.budget.search</field>
           <field name="model">building.budget</field>
           <field name="arch" type="xml">
               <search string="Building Budget">
                    <field name="name" string="Building Budget code"/>
                    <field name="date_from"/>
                    <field name="date_to"/>
                    <filter string="Draft" domain="[('state','=','draft')]" help="Draft items"/>
                    <filter string="To Approve" domain="[('state','=','sub')]" help="To Approve Budgets" />
                    <field name="state"/>
                </search>
            </field>
        </record>
    </data>

    <data>
        <record id="seq_custom_budget" model="ir.sequence">
            <field name="name">budget.custom</field>
            <field name="code">budget.custom</field>
            <field name="prefix">B/</field>
            <field name="padding">5</field>
        </record>
        <record id="seq_building_budget" model="ir.sequence">
            <field name="name">building.budget</field>
            <field name="code">building.budget</field>
            <field name="prefix">BB/</field>
            <field name="padding">5</field>
        </record>
    </data>-->
